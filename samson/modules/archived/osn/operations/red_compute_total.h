
/**
 File autogenerated with samsonModuleParser. Please, edit to complete this operation
*/

#ifndef _H_SAMSON_osn_red_compute_total
#define _H_SAMSON_osn_red_compute_total


#include <samson/module/samson.h>



namespace samson{
namespace osn{


	class red_compute_total : public samson::Reduce
	{
                samson::system::UInt key_in;
                samson::osn::Count count;
		samson::system::UInt total_out;
                samson::system::Void void_out;


	public:


		void run(  samson::KVSetStruct* inputs , samson::KVWriter *writer )
		{

			total_out.value = 0;
                        for (size_t i = 0; (i < inputs[0].num_kvs); i++)
                        {
                                key_in.parse(inputs[0].kvs[i]->key);
                                count.parse(inputs[0].kvs[i]->value);

				total_out.value += count.count.value;

                        }
			writer->emit(0, &total_out, &void_out);
		}


	};


} // end of namespace samson
} // end of namespace osn

#endif
